# Домашнее задание к занятию "Языки разметки JSON и YAML"

### Цель задания

В результате выполнения этого задания вы:

1. Познакомитесь с синтаксисами JSON и YAML.
2. Узнаете как преобразовать один формат в другой при помощи пары строк.

### Чеклист готовности к домашнему заданию

Установлена библиотека pyyaml для Python 3.

### Инструкция к заданию 

1. Скопируйте в свой .md-файл содержимое этого файла; исходники можно посмотреть [здесь](https://raw.githubusercontent.com/netology-code/sysadm-homeworks/devsys10/04-script-03-yaml/README.md).
2. Заполните недостающие части документа решением задач (заменяйте `???`, остальное в шаблоне не меняйте, чтобы не сломать форматирование текста, подсветку синтаксиса и прочее) и отправляйте на проверку. Вместо логов можно вставить скриншоты по желанию.
3. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.

### Дополнительные материалы

[Полезные ссылки для модуля "Скриптовые языки и языки разметки"](https://github.com/netology-code/sysadm-homeworks/tree/devsys10/04-script-03-yaml/additional-info)

------

## Задание 1

Мы выгрузили JSON, который получили через API запрос к нашему сервису:

```
    { "info" : "Sample JSON output from our service\t",
        "elements" :[
            { "name" : "first",
            "type" : "server",
            "ip" : 7175 
            }
            { "name" : "second",
            "type" : "proxy",
            "ip : 71.78.22.43
            }
        ]
    }
```
  Нужно найти и исправить все ошибки, которые допускает наш сервис

### Ваш скрипт:
```json
{ "info" : "Sample JSON output from our service\t",
"elements" :[
    { "name" : "first",
    "type" : "server",
    "ip" : 7175 
    }
    { "name" : "second",
    "type" : "proxy",
    "ip" : "71.78.22.43"
    }
]
}
```

---

## Задание 2

В прошлый рабочий день мы создавали скрипт, позволяющий опрашивать веб-сервисы и получать их IP. К уже реализованному функционалу нам нужно добавить возможность записи JSON и YAML файлов, описывающих наши сервисы. Формат записи JSON по одному сервису: `{ "имя сервиса" : "его IP"}`. Формат записи YAML по одному сервису: `- имя сервиса: его IP`. Если в момент исполнения скрипта меняется IP у сервиса - он должен так же поменяться в yml и json файле.

### Ваш скрипт:
```python
import time
import socket
import json
import yaml

site= ["drive.google.com", "mail.google.com", "google.com"]
#Определяем IP 
d=(socket.gethostbyname_ex(site[0]))[2]
m=(socket.gethostbyname_ex(site[1]))[2]
g=(socket.gethostbyname_ex(site[2]))[2]

#Преобразуем в число
drive=str(d)[2:-2]
mail=str(m)[2:-2]
goog=str(g)[2:-2]

def jes():
    with open("service" + ".json", "a") as js:
        data_js=json.dumps({test: new_addr})
        js.write(f"{data_js}\n") 
def yml():
    with open("service" + ".yaml", "a") as ym:
        data_ym=yaml.dump([{test: new_addr}])
        ym.write(data_ym)
def all():
    jes()
    yml()

while True:
    print("******************************************")
    for test in site:
        new_addr=socket.gethostbyname_ex(test)[2]
        jes()
        yml()
        
        if new_addr ==d:
            print(f"drive.google.com\t" , "-", drive)
        elif new_addr == m:
            print (f"mail.google.com\t\t" , "-", mail)
        elif new_addr == g:
            print (f"google.com\t\t" , "-", goog)
        else:
            if test == site[0]:
                print (f"[ERROR]", test, "IP mismatch:", d, ">", new_addr[0])
                all() 
            elif test == site[1]:
                print (f"[ERROR]", test, "IP mismatch:", m, ">", new_addr[0])
                all()
            elif test == site[2]:
                print (f"[ERROR]", test, "IP mismatch:", goog, ">", new_addr[0])
                all()
            else:
               break
    print("******************************************\n")
    time.sleep(30)
```

### Вывод скрипта при запуске при тестировании:
```bash
bortnik@Server3:~$ python3 1.py
******************************************
drive.google.com         - 142.251.141.46
mail.google.com          - 142.250.187.101
google.com               - 142.250.187.142
******************************************
```

### json-файл(ы), который(е) записал ваш скрипт:
```json
bortnik@Server3:~$ cat service.json
{"drive.google.com": ["142.251.141.46"]}
{"mail.google.com": ["142.250.187.101"]}
{"google.com": ["142.250.187.142"]}
```

### yml-файл(ы), который(е) записал ваш скрипт:
```yaml
bortnik@Server3:~$ cat service.yaml
- drive.google.com:
  - 142.251.141.46
- mail.google.com:
  - 142.250.187.101
- google.com:
  - 142.250.187.142
```

---

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Так как команды в нашей компании никак не могут прийти к единому мнению о том, какой формат разметки данных использовать: JSON или YAML, нам нужно реализовать парсер из одного формата в другой. Он должен уметь:
   * Принимать на вход имя файла
   * Проверять формат исходного файла. Если файл не json или yml - скрипт должен остановить свою работу
   * Распознавать какой формат данных в файле. Считается, что файлы *.json и *.yml могут быть перепутаны
   * Перекодировать данные из исходного формата во второй доступный (из JSON в YAML, из YAML в JSON)
   * При обнаружении ошибки в исходном файле - указать в стандартном выводе строку с ошибкой синтаксиса и её номер
   * Полученный файл должен иметь имя исходного файла, разница в наименовании обеспечивается разницей расширения файлов

### Ваш скрипт:
```python
???
```

### Пример работы скрипта:
???

----

### Правила приема домашнего задания

В личном кабинете отправлена ссылка на .md файл в вашем репозитории.

-----

### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки. 
 
Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.
Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.
