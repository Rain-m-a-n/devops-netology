# Домашнее задание к занятию «Управление доступом»### Цель заданияВ тестовой среде Kubernetes нужно предоставить ограниченный доступ пользователю.------<details><summary>Дополнительные материалы</summary>1. [Описание](https://kubernetes.io/docs/reference/access-authn-authz/rbac/) RBAC.2. [Пользователи и авторизация RBAC в Kubernetes](https://habr.com/ru/company/flant/blog/470503/).3. [RBAC with Kubernetes in Minikube](https://medium.com/@HoussemDellai/rbac-with-kubernetes-in-minikube-4deed658ea7b).</details>------### Задание 1. Создайте конфигурацию для подключения пользователя1. Создайте и подпишите SSL-сертификат для подключения к кластеру.    ```bash    > $ openssl genrsa -out user1.key 2048                                                            [±kuber_(2.4) ●●●]    > $ openssl req -new -key user1.key -out user1.csr -subj "/CN=user1/O=dev"                        [±kuber_(2.4) ●●●]    > $ openssl x509 -req -in user1.csr -CA ./ca.crt -CAkey ./ca.key -CAcreateserial -out user1.crt -days 30    Certificate request self-signature ok    subject=CN = user1, O = dev    ```2. Настройте конфигурационный файл kubectl для подключения.    ```bash    > $ kube config set-credentials user1 --client-certificate user1.crt --client-key user1.key       [±kuber_(2.4) ●●●]    User "user1" set.    ```3. Создайте роли и все необходимые настройки для пользователя.    ```bash    > $ kube config view                                                                              [±kuber_(2.4) ●●●]    apiVersion: v1    clusters:    - cluster:        certificate-authority-data: DATA+OMITTED        server: https://127.0.0.1:16443      name: microk8s-cluster    contexts:    - context:        cluster: microk8s-cluster        user: admin        name: microk8s    - context:        cluster: microk8s-cluster        namespace: kuber-2-4        user: user1      name: user1    current-context: microk8s    kind: Config    preferences: {}    users:    - name: admin      user:        token: REDACTED    - name: user1      user:        client-certificate: /home/ubuntu/IdeaProjects/devops-netology/Конфигурация Kubernetes/Kuber_(2.4)/user1.crt        client-key: /home/ubuntu/IdeaProjects/devops-netology/Конфигурация Kubernetes/Kuber_(2.4)/user1.key    ```4. Предусмотрите права пользователя. Пользователь может просматривать логи подов и их конфигурацию (`kubectl logs pod <pod_id>`, `kubectl describe pod <pod_id>`).    ```bash    > $ kube describe roles.rbac.authorization.k8s.io -n kuber-2-4                                                 [±kuber_(2.4) ●●●]    Name:         logs-and-config    Labels:       <none>    Annotations:  <none>    PolicyRule:    Resources  Non-Resource URLs  Resource Names  Verbs    ---------  -----------------  --------------  -----    pods/log   []                 []              [get watch list describe]    pods       []                 []              [get watch list describe]    ```   ```bash    > $ kube get pods                                                                                              [±kuber_(2.4) ●●●]    NAME        READY   STATUS    RESTARTS   AGE    multitool   1/1     Running   0          175m    ```    ```bash    > $ kube describe pod multitool                                                                                [±kuber_(2.4) ●●●]    Name:             multitool    Namespace:        kuber-2-4    Priority:         0    Service Account:  netology    Node:             ubuntu/192.168.119.128    Start Time:       Sun, 12 Nov 2023 16:04:28 +0300    Labels:           <none>    Annotations:      cni.projectcalico.org/containerID: 5ff5f2bca6cf1d563ea26fbd8eeb7058ce2bb7c939bd5b723e94a28a80e5b662                      cni.projectcalico.org/podIP: 10.1.243.236/32                      cni.projectcalico.org/podIPs: 10.1.243.236/32    Status:           Running    IP:               10.1.243.236    IPs:      IP:  10.1.243.236    Containers:      test-multitool:        Container ID:   containerd://5262e3f873ceb14e04ab60e575cf8513cebdc24bbbe3c35eda108d75379b5169        Image:          wbitt/network-multitool        Image ID:       docker.io/wbitt/network-multitool@sha256:d1137e87af76ee15cd0b3d4c7e2fcd111ffbd510ccd0af076fc98dddfc50a735        Port:           <none>        Host Port:      <none>        State:          Running          Started:      Sun, 12 Nov 2023 16:04:30 +0300        Ready:          True        Restart Count:  0        Environment:    <none>        Mounts:          /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-kc52m (ro)    Conditions:      Type              Status      Initialized       True      Ready             True      ContainersReady   True      PodScheduled      True    Volumes:      kube-api-access-kc52m:        Type:                    Projected (a volume that contains injected data from multiple sources)        TokenExpirationSeconds:  3607        ConfigMapName:           kube-root-ca.crt        ConfigMapOptional:       <nil>        DownwardAPI:             true    QoS Class:                   BestEffort    Node-Selectors:              <none>    Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s                                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s    Events:                      <none>    ```    ```bash    > $ kube logs multitool                                                                                        [±kuber_(2.4) ●●●]    The directory /usr/share/nginx/html is not mounted.    Therefore, over-writing the default index.html file with some useful information:    WBITT Network MultiTool (with NGINX) - multitool - 10.1.243.236 - HTTP: 80 , HTTPS: 443 . (Formerly praqma/network-multitool)    ```6. Предоставьте манифесты и скриншоты и/или вывод необходимых команд.   [deployment](https://github.com/Rain-m-a-n/devops-netology/blob/master/Конфигурация%20Kubernetes/Kuber_(2.4)/task2.yml)------